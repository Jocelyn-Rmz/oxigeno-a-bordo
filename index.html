<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Rescate Submarino ‚Ä¢ 10 Niveles + HUD</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Bootstrap 5 + Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>
  <style>
    :root{
      --ink:#0b0f17; --sea:#071421; --panel:#0f172a; --muted:#94a3b8;
      --accent:#22d3ee; --accent2:#38bdf8; --danger:#ef4444; --warn:#f59e0b; --ok:#22c55e;
    }
    body{
      /* Cielo/agua exterior a la p√°gina */
      background:
        radial-gradient(1200px 600px at 50% 10%, #12395c 0%, #0b1a2a 55%, #070d17 100%);
      color:#e5e7eb; min-height:100vh;
    }
    .navbar{ background:#0f172a; box-shadow:0 10px 30px rgba(0,0,0,.35); }
    .brand-gradient{ background: linear-gradient(90deg,var(--accent),var(--accent2));
      -webkit-background-clip:text; background-clip:text; color:transparent; }
    .game-card{
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      border:1px solid rgba(148,163,184,.15); border-radius:16px;
    }
    canvas{
      display:block; margin:0 auto;
      /* el ‚Äòmar‚Äô real se dibuja por JS; esto es un back-up */
      background: radial-gradient(800px 400px at 50% 40%, #0e2e4d 0%, #0a1e32 60%, #071625 100%);
      border-radius:16px;
      box-shadow:0 20px 50px rgba(0,0,0,.45), inset 0 0 0 1px rgba(148,163,184,.08);
    }
    .hud-card{
      background:linear-gradient(180deg, rgba(56,189,248,.08), rgba(34,211,238,.06));
      border:1px solid rgba(148,163,184,.15); border-radius:16px;
    }
    .info-card{
      background:linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid rgba(148,163,184,.15); border-radius:16px;
    }
    .stat{ font-variant-numeric:tabular-nums }
    .badge-soft{ background:rgba(148,163,184,.18); color:#cbd5e1; border:1px solid rgba(148,163,184,.25); }
    .btn-accent{ background:linear-gradient(90deg,var(--accent),var(--accent2)); border:none; color:#0b0f17; font-weight:600; }
  </style>
</head>
<body>
  <!-- NAV -->
  <nav class="navbar navbar-dark mb-4">
    <div class="container">
      <span class="navbar-brand">
        <i class="bi bi-joystick"></i> <strong class="brand-gradient">Rescate Submarino</strong>
      </span>
      <div class="d-flex gap-2">
        <button id="btnStart"  class="btn btn-accent btn-sm"><i class="bi bi-play-fill"></i> Iniciar</button>
        <button id="btnPause"  class="btn btn-outline-light btn-sm"><i class="bi bi-pause-fill"></i> Pausa</button>
        <button id="btnResume" class="btn btn-outline-light btn-sm"><i class="bi bi-play"></i> Reanudar</button>
        <button id="btnRestart" class="btn btn-outline-info btn-sm"><i class="bi bi-arrow-counterclockwise"></i> Reiniciar</button>
        <!-- NUEVO: Terminar -->
        <button id="btnEnd" class="btn btn-danger btn-sm"><i class="bi bi-stop-fill"></i> Terminar</button>
      </div>
    </div>
  </nav>

  <main class="container">
    <div class="row g-3 mb-3">
      <!-- LATERAL: HUD + INDICACIONES -->
      <div class="col-12 col-lg-3 d-flex flex-column gap-3">
        <!-- HUD -->
        <div class="p-3 hud-card">
          <h6 class="mb-3"><i class="bi bi-speedometer"></i> Panel</h6>
          <div class="d-flex justify-content-between align-items-center">
            <span>Nivel</span><span id="hudLevel" class="stat fw-bold">1 / 10</span>
          </div>
          <div class="d-flex justify-content-between align-items-center">
            <span>Ox√≠geno</span><span id="hudTokens" class="stat fw-bold">0 / 10</span>
          </div>
          <div class="d-flex justify-content-between align-items-center">
            <span>Vidas</span><span id="hudLives" class="stat fw-bold">3</span>
          </div>
          <div class="d-flex justify-content-between align-items-center">
            <span>Puntos</span><span id="hudScore" class="stat fw-bold">0</span>
          </div>
          <div class="d-flex justify-content-between align-items-center">
            <span>Velocidad</span><span id="hudSpeed" class="stat fw-bold">1.0x</span>
          </div>
        </div>
        <!-- INDICACIONES -->
        <div class="p-3 info-card">
          <h6 class="mb-3"><i class="bi bi-info-circle"></i> Indicaciones</h6>
          <ul class="small mb-2">
            <li><strong>Objetivo:</strong> Recolecta <strong>10 tanques de ox√≠geno</strong> por nivel.</li>
            <li><strong>Controles:</strong> <span class="badge badge-soft">WASD</span> o <span class="badge badge-soft">Flechas</span> para mover el <em>submarino</em>.</li>
            <li><strong>Peligros:</strong> Evita las <em>minas</em> y cuida las <em>corrientes</em> que te empujan.</li>
            <li><strong>Power-ups:</strong> üõ° escudo, üê¢ ralentiza minas, ‚òÖ +puntos.</li>
            <li><strong>Niveles:</strong> 10 niveles; la velocidad e intensidad aumentan.</li>
            <li><strong>Pausa:</strong> Usa los botones de arriba.</li>
            <li><strong>Terminar partida:</strong> Pulsa <span class="badge bg-danger">Terminar</span> o, al cerrar un nivel, elige <em>‚ÄúTerminar aqu√≠‚Äù</em>.</li>
          </ul>
          <div class="text-muted small">Todo se mantiene dentro del canvas.</div>
        </div>
      </div>

      <!-- CANVAS -->
      <div class="col-12 col-lg-9">
        <div class="p-3 game-card rounded-3">
          <div class="d-flex justify-content-between align-items-center mb-2">
            <div>
              <span class="badge badge-soft me-1"><i class="bi bi-arrows-move"></i> WASD / Flechas</span>
              <span class="badge badge-soft me-1"><i class="bi bi-shield"></i> Escudo</span>
              <span class="badge badge-soft"><i class="bi bi-wind"></i> Corrientes</span>
            </div>
            <div><span class="text-muted small">No se salen del canvas</span></div>
          </div>
          <canvas id="game" width="900" height="520" aria-label="Rescate Submarino"></canvas>
        </div>
      </div>
    </div>

    <!-- Cr√©ditos -->
    <div class="text-center text-muted mt-3">
      <small>Canvas 2D ‚Ä¢ Bootstrap 5 ‚Ä¢ 10 niveles ‚Ä¢ 10 tanques por nivel</small>
    </div>
  </main>

  <!-- Modal entre niveles (ahora con ‚ÄúTerminar aqu√≠‚Äù) -->
  <div class="modal fade" id="levelModal" tabindex="-1" aria-labelledby="levelModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-light">
        <div class="modal-header">
          <h5 class="modal-title" id="levelModalLabel">Resultados del Nivel</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          <p id="levelSummary" class="mb-0"></p>
        </div>
        <div class="modal-footer">
          <button id="btnEndHere" type="button" class="btn btn-outline-danger" data-bs-dismiss="modal">
            <i class="bi bi-stop-fill"></i> Terminar aqu√≠
          </button>
          <button id="btnNextLevel" type="button" class="btn btn-accent" data-bs-dismiss="modal">
            <i class="bi bi-chevron-right"></i> Siguiente nivel
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal resumen final -->
  <div class="modal fade" id="finalModal" tabindex="-1" aria-labelledby="finalModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-light">
        <div class="modal-header">
          <h5 class="modal-title" id="finalModalLabel">Resumen Final</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body"><div id="finalSummary"></div></div>
        <div class="modal-footer">
          <button id="btnPlayAgain" type="button" class="btn btn-accent" data-bs-dismiss="modal">
            <i class="bi bi-arrow-repeat"></i> Jugar de nuevo
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal confirmar ‚ÄúTerminar‚Äù (desde la navbar) -->
  <div class="modal fade" id="endConfirmModal" tabindex="-1" aria-labelledby="endConfirmLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content bg-dark text-light">
        <div class="modal-header">
          <h5 class="modal-title" id="endConfirmLabel"><i class="bi bi-exclamation-triangle-fill text-warning"></i> ¬øTerminar partida?</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Cerrar"></button>
        </div>
        <div class="modal-body">
          Se mostrar√° tu resumen con los niveles completados y tu puntuaci√≥n actual.
        </div>
        <div class="modal-footer">
          <button id="btnCancelEnd" type="button" class="btn btn-outline-light" data-bs-dismiss="modal">Seguir jugando</button>
          <button id="btnConfirmEnd" type="button" class="btn btn-danger">Terminar ahora</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Toast (vidas restantes) -->
  <div class="toast-container position-fixed top-0 end-0 p-3" style="z-index:1080;">
    <div id="lifeToast" class="toast align-items-center text-bg-danger border-0" role="alert" aria-live="assertive" aria-atomic="true">
      <div class="d-flex">
        <div class="toast-body" id="lifeToastBody">¬°Impacto! Te quedan 2 vidas.</div>
        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Cerrar"></button>
      </div>
    </div>
  </div>

  <!-- Bootstrap + Juego -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="js/main.js"></script>
</body>
</html>
